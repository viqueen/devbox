#! /usr/bin/env bash

source selfedit.sh

# @COMMAND path [url] [directory]        clones git repo checking out given path only
function path() {
  _with_arguments 2 "$@"
  connection=${1}
  directory=${2}

  if [[ ${connection} =~ ^git@([a-zA-Z\.]+):([a-zA-Z0-9\-]+)/([a-zA-Z0-9\-]+)\.git$ ]];
  then
    module=${BASH_REMATCH[3]}
  else
    echo 'invalid git ssh connection url'
    exit 1
  fi

  git clone --sparse --filter=blob:none --depth=1 "${connection}"
  cd "${module}" || exit
  git sparse-checkout add "${directory}"
}

eval "$@"

if [[ -z $1 ]]; then
    $0 -h
fi
